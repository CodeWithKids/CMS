import{r as n,G as f,H as M,I as O,j as e,S as h,J as R,K as B,M as F,N as U,O as V,A as q,C as N,e as G,f as H,B as K,i as l,k as o,l as m,o as x,w as j,n as v,P as W,Q as _,h as r,R as b,U as J,V as Q,W as X,X as Y,Y as z}from"./index-C7xgdnS2.js";const y=new Date().toISOString().split("T")[0];function $(){const[p,w]=n.useState("t1"),[S,I]=n.useState(!1),[T,k]=n.useState(!0);n.useEffect(()=>{const s=setTimeout(()=>k(!1),200);return()=>clearTimeout(s)},[]),n.useMemo(()=>f.find(s=>s.id===p),[p]);const c=M({termId:p}),C=O(),d=n.useMemo(()=>{const s=c,i=s.reduce((t,a)=>t+a.grossAmount,0),u=s.reduce((t,a)=>t+a.discountAmount,0),D=s.reduce((t,a)=>t+a.netAmount,0),E=s.reduce((t,a)=>t+a.amountPaid,0),P=s.reduce((t,a)=>t+Math.max(0,a.balance),0),L=s.filter(t=>t.dueDate<y&&t.balance>0).reduce((t,a)=>t+a.balance,0);return{totalGross:i,totalDiscounts:u,netInvoiced:D,amountPaid:E,outstanding:P,overdue:L}},[c]),g=n.useMemo(()=>{const s=new Map;for(const i of c){const u=i.status;s.set(u,(s.get(u)??0)+1)}return Array.from(s.entries()).map(([i,u])=>({status:i,count:u}))},[c]),A=n.useMemo(()=>c.filter(s=>s.dueDate<y&&s.balance>0).length,[c]);return T?e.jsxs("div",{className:"p-6 space-y-8",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(h,{className:"h-8 w-56 mb-2"}),e.jsx(h,{className:"h-5 w-80"})]}),e.jsx(h,{className:"h-10 w-[180px]"})]}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-5",children:[1,2,3,4,5].map(s=>e.jsx(h,{className:"h-24"},s))}),e.jsx(h,{className:"h-48 w-full"}),e.jsx(h,{className:"h-64 w-full"})]}):e.jsxs("div",{className:"p-6 space-y-8",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Finance dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Key metrics, invoices, and quick links for the selected term."})]}),e.jsxs(R,{value:p,onValueChange:w,children:[e.jsx(B,{className:"w-[180px]",children:e.jsx(F,{placeholder:"Term"})}),e.jsx(U,{children:f.map(s=>e.jsx(V,{value:s.id,children:s.name},s.id))})]})]}),S&&e.jsxs(q,{variant:"destructive",children:[e.jsx(N,{className:"h-4 w-4"}),e.jsx(G,{children:"Something went wrong"}),e.jsxs(H,{children:["We couldn't load the dashboard."," ",e.jsx(K,{variant:"link",className:"p-0 h-auto font-medium",onClick:()=>I(!1),children:"Try again"})]})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-5",children:[e.jsxs(l,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(m,{className:"text-sm font-medium text-muted-foreground",children:"Total gross invoiced"})}),e.jsx(x,{children:e.jsx("p",{className:"text-2xl font-bold",children:j(d.totalGross)})})]}),e.jsxs(l,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(m,{className:"text-sm font-medium text-muted-foreground",children:"Total discounts given"})}),e.jsx(x,{children:e.jsx("p",{className:"text-2xl font-bold",children:j(d.totalDiscounts)})})]}),e.jsxs(l,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(m,{className:"text-sm font-medium text-muted-foreground",children:"Net invoiced"})}),e.jsx(x,{children:e.jsx("p",{className:"text-2xl font-bold",children:j(d.netInvoiced)})})]}),e.jsxs(l,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(m,{className:"text-sm font-medium text-muted-foreground",children:"Amount paid"})}),e.jsx(x,{children:e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:j(d.amountPaid)})})]}),e.jsxs(l,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(m,{className:"text-sm font-medium text-muted-foreground",children:"Outstanding (incl. overdue)"})}),e.jsxs(x,{children:[e.jsx("p",{className:"text-2xl font-bold",children:j(d.outstanding)}),d.overdue>0&&e.jsxs("p",{className:"text-xs text-amber-600 dark:text-amber-400 mt-1",children:[j(d.overdue)," overdue"]})]})]})]}),e.jsxs(l,{children:[e.jsxs(o,{children:[e.jsx(m,{children:"Invoices by status"}),e.jsx(v,{children:"Count of invoices in this term by status (issued, paid, overdue, etc.)."})]}),e.jsx(x,{children:g.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No invoices for this term."}):e.jsx("div",{className:"flex flex-wrap gap-4",children:g.map(({status:s,count:i})=>e.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-lg bg-muted text-sm",children:[e.jsx("span",{className:"font-medium",children:W[s]??s}),e.jsx("span",{className:"text-muted-foreground",children:i})]},s))})})]}),e.jsxs(l,{children:[e.jsxs(o,{children:[e.jsxs(m,{className:"flex items-center gap-2",children:[e.jsx(_,{className:"w-5 h-5"})," Finance home"]}),e.jsx(v,{children:"Invoices, educator payments, session expenses, organisational expenses, and inventory. One place for all finance operations."})]}),e.jsx(x,{children:e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(r,{to:"/finance/invoices",className:"flex items-center gap-3 p-4 rounded-lg border bg-card hover:bg-muted/50 transition-colors",children:[e.jsx(b,{className:"w-8 h-8 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Invoices"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[c.length," in this term"]})]})]}),e.jsxs(r,{to:"/finance/invoices?status=overdue",className:"flex items-center gap-3 p-4 rounded-lg border bg-card hover:bg-muted/50 transition-colors",children:[e.jsx(N,{className:"w-8 h-8 text-amber-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Overdue invoices"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[A," overdue"]})]})]}),e.jsxs(r,{to:"/finance/adjustments",className:"flex items-center gap-3 p-4 rounded-lg border bg-card hover:bg-muted/50 transition-colors",children:[e.jsx(J,{className:"w-8 h-8 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Pending adjustments"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[C.length," discount/refund requests"]})]})]}),e.jsxs(r,{to:"/finance/educators",className:"flex items-center gap-3 p-4 rounded-lg border bg-card hover:bg-muted/50 transition-colors",children:[e.jsx(Q,{className:"w-8 h-8 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Educator earnings & hours"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Payments and session data"})]})]}),e.jsxs(r,{to:"/finance/session-expenses",className:"flex items-center gap-3 p-4 rounded-lg border bg-card hover:bg-muted/50 transition-colors",children:[e.jsx(X,{className:"w-8 h-8 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Session expenses"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Educator transport & costs"})]})]}),e.jsxs(r,{to:"/finance/expenses",className:"flex items-center gap-3 p-4 rounded-lg border bg-card hover:bg-muted/50 transition-colors",children:[e.jsx(Y,{className:"w-8 h-8 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Organisation expenses"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Rent, equipment, etc."})]})]}),e.jsxs(r,{to:"/finance/inventory",className:"flex items-center gap-3 p-4 rounded-lg border bg-card hover:bg-muted/50 transition-colors",children:[e.jsx(z,{className:"w-8 h-8 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Inventory"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Devices and kits"})]})]}),e.jsxs(r,{to:"/finance/reports",className:"flex items-center gap-3 p-4 rounded-lg border bg-card hover:bg-muted/50 transition-colors",children:[e.jsx(b,{className:"w-8 h-8 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Reports"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Income and analytics"})]})]})]})})]})]})}export{$ as default};
